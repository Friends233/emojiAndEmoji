var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},__extends=function(e,t){function n(){this.constructor=e}extendStatics(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},__assign=Object.assign||function(e){for(var t,n=1,r=arguments.length;r>n;n++){t=arguments[n];for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},__rest=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var o=0,r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]]);return n},__decorate=function(e,t,n,r){var o,i=arguments.length,a=3>i?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(3>i?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},__param=function(e,t){return function(n,r){t(n,r,e)}},__metadata=function(e,t){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(e,t):void 0},__awaiter=function(e,t,n,r){function o(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,i){function a(e){try{c(r.next(e))}catch(t){i(t)}}function u(e){try{c(r["throw"](e))}catch(t){i(t)}}function c(e){e.done?n(e.value):o(e.value).then(a,u)}c((r=r.apply(e,t||[])).next())})},__generator=function(e,t){function n(e){return function(t){return r([e,t])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;c;)try{if(o=1,i&&(a=2&n[0]?i["return"]:n[0]?i["throw"]||((a=i["return"])&&a.call(i),0):i.next)&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[2&n[0],a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=t.call(e,c)}catch(r){n=[6,r],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,u,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return u={next:n(0),"throw":n(1),"return":n(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u},__exportStar=function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||__createBinding(t,e,n)},__createBinding=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},__values=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-->0)&&!(r=i.next()).done;)a.push(r.value)}catch(u){o={error:u}}finally{try{r&&!r.done&&(n=i["return"])&&n.call(i)}finally{if(o)throw o.error}}return a},__spread=function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e},__spreadArrays=function(){for(var e=0,t=0,n=arguments.length;n>t;t++)e+=arguments[t].length;for(var r=Array(e),o=0,t=0;n>t;t++)for(var i=arguments[t],a=0,u=i.length;u>a;a++,o++)r[o]=i[a];return r},__await=function(e){return this instanceof __await?(this.v=e,this):new __await(e)},__asyncGenerator=function(e,t,n){function r(e){l[e]&&(s[e]=function(t){return new Promise(function(n,r){f.push([e,t,n,r])>1||o(e,t)})})}function o(e,t){try{i(l[e](t))}catch(n){c(f[0][3],n)}}function i(e){e.value instanceof __await?Promise.resolve(e.value.v).then(a,u):c(f[0][2],e)}function a(e){o("next",e)}function u(e){o("throw",e)}function c(e,t){e(t),f.shift(),f.length&&o(f[0][0],f[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s,l=n.apply(e,t||[]),f=[];return s={},r("next"),r("throw"),r("return"),s[Symbol.asyncIterator]=function(){return this},s},__asyncDelegator=function(e){function t(t,o){n[t]=e[t]?function(n){return(r=!r)?{value:__await(e[t](n)),done:"return"===t}:o?o(n):n}:o}var n,r;return n={},t("next"),t("throw",function(e){throw e}),t("return"),n[Symbol.iterator]=function(){return this},n},__asyncValues=function(e){function t(t){r[t]=e[t]&&function(r){return new Promise(function(o,i){r=e[t](r),n(o,i,r.done,r.value)})}}function n(e,t,n,r){Promise.resolve(r).then(function(t){e({value:t,done:n})},t)}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=e[Symbol.asyncIterator];return o?o.call(e):(e="function"==typeof __values?__values(e):e[Symbol.iterator](),r={},t("next"),t("throw"),t("return"),r[Symbol.asyncIterator]=function(){return this},r)},__makeTemplateObject=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__setModuleDefault=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t},__importStar=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&__createBinding(t,e,n);return __setModuleDefault(t,e),t},__importDefault=function(e){return e&&e.__esModule?e:{"default":e}},__classPrivateFieldGet=function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},__reflect=function(e,t,n){e.__class__=t,n?n.push(t):n=[t],e.__types__=e.__types__?n.concat(e.__types__):n};!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:r})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)t.d(r,o,function(t){return e[t]}.bind(null,o));return r},t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,n){function r(e){var t=Math.ceil(Math.random()*(e.length-1)),n=e[t];return e.splice(t,1),n}n(1),n(2);var o=5;window.MAX_NUM=o;var i=3;window.ACT_LEVEL=i;var a=20;window.halfW=a;var u=92,c=92;window.offsetX=u,window.offsetY=c,window.getAryRand=r;var s=function(e){function t(){var t=e.call(this)||this;return t.emojiMannager=null,t.emojiPlayer=null,t.addEventListener(egret.Event.ADDED_TO_STAGE,t.onAddToStage,t),t}return __extends(t,e),t.prototype.onAddToStage=function(e){egret.lifecycle.addLifecycleListener(function(e){e.onUpdate=function(){}}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()},this.runGame()["catch"](function(e){console.log(e)})},t.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[4,RES.getResAsync("description_json")];case 2:return e=t.sent(),[2]}})})},t.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),e=new LoadingUI,this.stage.addChild(e),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return n.sent(),[4,RES.loadGroup("preload",0,e)];case 2:return n.sent(),this.stage.removeChild(e),[3,4];case 3:return t=n.sent(),console.error(t),[3,4];case 4:return[2]}})})},t.prototype.createGameScene=function(){var e=this.stage.stageWidth,t=this.createBitmapByName("bg_png");t.fillMode=egret.BitmapFillMode.REPEAT,this.addChild(t);var n=this.emojiPlayer=new p(this.stage);n.$setX((e-n.width)/2),n.$setY(1200),this.stage.addChild(n),this.createEmoji()},t.prototype.createEmoji=function(){this.emojiMannager=new l(this.stage,this.emojiPlayer)},t.prototype.createBitmapByName=function(e){var t=new egret.Bitmap,n=RES.getRes(e);return t.texture=n,t},t}(egret.DisplayObjectContainer);window.Main=s,__reflect(s.prototype,"Main",[]);var l=function(){function e(e,t){this.stage=null,this.emojiPool=[],this.emojiPlayer=null,this.stage=e,this.emojiPlayer=t,this.initEmojiPool(),this.createEmoji()}return e.prototype.initEmojiPool=function(){for(var e=this,t=i*o*o*2,n=function(t){var n=new f(t);n.touchEnabled=!0,n.addEventListener(egret.TouchEvent.TOUCH_TAP,function(){e.emojiPlayer.launchTween(n)},r),r.emojiPool.push(n)},r=this,a=0;t>a;a++)n(a)},e.prototype.getRandomEmoji=function(){return r(this.emojiPool)},e.prototype.createEmoji=function(){for(var e={x:.5*(this.stage.stageWidth-u*o+(u-72)),y:400},t=0;o>t;t++)for(var n=0;o>n;n++)for(var s=e.x+t*u,l=e.y+n*c,f=null,p=0;i>=p;p++){var h=this.getRandomEmoji();f?(f.nextEmoji=h,f=f.nextEmoji):f=h,h.$setX(s),h.$setY(l),h.deep=p,h.changeGrey(),this.stage.addChildAt(h,this.stage.numChildren-p);var d=[{tempX:s-a},{tempX:s+a},{tempY:l+a},{tempY:l+a}],y=r(d);s=y.tempX||s,l=y.tempY||l}},e}();window.EmojiMannager=l,__reflect(l.prototype,"EmojiMannager",[]);var f=function(e){function t(t){var n=e.call(this)||this;return n.key=0,n.type=0,n.deep=0,n.nextEmoji=null,n.key=t,n.init(),n}return __extends(t,e),t.prototype.init=function(){var e=new egret.Bitmap,t=this.key%o+1;this.type=t;var n=RES.getRes("emoji"+t+"_png");e.texture=n,this.addChild(e),this.width=72,this.height=72},t.prototype.refreshDeep=function(){this.deep<=0||(this.deep=0,this.changeGrey())},t.prototype.changeGrey=function(){var e=[.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0];this.deep<=0&&(e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]);var t=new egret.ColorMatrixFilter(e);this.filters=[t]},t.prototype.destEmoji=function(e){egret.Tween.get(this).to({alpha:0},300).call(function(){e&&e()})},t}(egret.DisplayObjectContainer);window.Emoji=f,__reflect(f.prototype,"Emoji",[]);var p=function(e){function t(t){var n=e.call(this)||this;return n.emojiStack=[],n.emojiEliMap={},n.stage=null,n.isTween=!1,n.initEmojiPlayer(),n.stage=t,n}return __extends(t,e),t.prototype.initEmojiPlayer=function(){var e=new egret.Shape,t=504,n=72;e.graphics.beginFill(0,.4),e.graphics.lineStyle(2,0),e.graphics.drawRect(0,0,t,n),e.graphics.endFill(),this.addChild(e)},t.prototype.launchTween=function(e){var t=this;if(!this.isTween&&!(this.emojiStack.length>=7||0!==e.deep)){this.isTween=!0;var n=new egret.Point(72*this.emojiStack.length+123,1200);this.emojiStack.push(e),this.emojiEliMap[e.type]||(this.emojiEliMap[e.type]=[]),e.touchEnabled=!1,this.emojiEliMap[e.type].push(e.key),e.nextEmoji&&e.nextEmoji.refreshDeep(),egret.Tween.get(e).to({x:n.x,y:n.y},400).call(function(){t.isEliminateEmoji()})}},t.prototype.isEliminateEmoji=function(){var e=this,t=Object.keys(this.emojiEliMap);t.forEach(function(t,n){var r=e.emojiEliMap[t]||[];r.length>=3&&(e.destEmoji(r),e.emojiEliMap[t]=[])}),this.isTween=!1,this.emojiStack.length>=7&&setTimeout(function(){alert("GAME OVER")},200)},t.prototype.destEmoji=function(e){var t=this,n=this.emojiStack.filter(function(n,r){var o=e.includes(n.key);return o&&n.destEmoji(function(){t.stage.removeChild(n)}),!o});this.emojiStack=n,this.refreEmojiPlayer()},t.prototype.refreEmojiPlayer=function(){this.emojiStack.forEach(function(e,t){var n=new egret.Point(72*t+123,1200);egret.Tween.get(e).to({x:n.x,y:n.y},200)})},t}(egret.DisplayObjectContainer);window.EmojiPlayer=p,__reflect(p.prototype,"EmojiPlayer",[])},function(e,t){var n=function(e){function t(){var t=e.call(this)||this;return t.createView(),t}return __extends(t,e),t.prototype.createView=function(){this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=300,this.textField.width=480,this.textField.height=100,this.textField.textAlign="center"},t.prototype.onProgress=function(e,t){this.textField.text="Loading..."+e+"/"+t},t}(egret.Sprite);window.LoadingUI=n,__reflect(n.prototype,"LoadingUI",["RES.PromiseTaskReporter"])},function(e,t){var n=function(){function e(){}return e.prototype.getUserInfo=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2,{nickName:"username"}]})})},e.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){return[2]})})},e}();window.DebugPlatform=n,__reflect(n.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new n)}]);